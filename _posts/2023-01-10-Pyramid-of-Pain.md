---
title: Pyramid of Pain
date: 2023-01-09 18:32:00 -0500
categories: [Lesson, Tryhackme]
tags: [SOC, SOC Analyst, Threat Hunting, Hashes]
---

![Pyramid of Pain](/assets/pop2.png)

Learn what is the Pyramid of Pain and how to utilize this model to determine the level of difficulty it will cause for an adversary to change the indicators associated with them, and their campaign. 

# Hash Values (Trivial)

A hash is the result of a hashing algorithm. A hash value is a unique value that identifies data. Some of the most common hashing algorithms are:

- **MD5 (Message Digest)** - Designed in 1992 and is a widely used cryptographic hash function with a 128-bit hash. **NOT** considered cryptographically secure. Vulnerable against a number of attacks including hash collision. Hash collision is when two different input values create the same hash. This can be used by an attacker to create a rogue version of the hash and use that hash to gain access to the legitimate file with the same MD5 hash.
- **SHA-1 (Secure Hashing Algorithm 1)** - Was designed by the bad guys at the NSA. of couse they build backdoors into algorithm just like the CIA did. It's not secure and banned for its use now because it's succeptable to brute force attacks.
- **SHA-2 (Secure Hashing Algorihm 2)** - Designed by the NIST and the NSA (uh-oh) to replace SHA-1. It has lots of variants, the most comming being SHA-256. The SHA-256 algo returns a hash value of 256-bits as a 64 digit hexadecimal number.

Like we said before about MD5 - a hash is not considered to be cryptographically secure if it two files are able to have the same hash value or digest. The main difference between a hash digest and a hash value is that a digest is the output of a specific hashing algorithm, while a hash value can be generated by any hashing algorithm.

You can use the hash values of files to determine if the file is malicious as they are unique.

We can use online tooks to do hash lookups, such as:- [VirusTotal](https://www.virustotal.com), and [Metadefender Cloud - OPSWAT](https://metadefender.opswat.com/?lang=en).

Now as we can see its pretty easy to determine if a file is malicious or not if we have its hash right? Wrong. It is trivial for an attacker to modify malware if they know what they are going and they can easily modify just a character in the code to produce a new hash value, which makes threat hunting using file hashes a very difficult task.

# IP Address (Easy)

IP addresses are used to identify any decive connected to any network. From a defenders standpoint knowing where the malicious attacks are coming from is super valuable. If we have an IP address we can block, drop, or deny requests from them via a firewall. This tactic only works until the attacker can find another IP address and an experienced attacker has no trouble getting a new one.

One way an attacker can make it challenging for a defender to successfully IP block is by using **Fast Flux**.

Fast Flux is a DNS technique used by botnets to hide phishing, web proxying, malware delivery and malware communication by hiding behind compromised hosts acting as proxies. The purpose of using Fast flux is to make the communication between malware and command and control centers challenging to be discovered by the SOC.

[Fast Flux 101: How Cybercriminals Improve the Resilience of Their Infrastructure to Evade Detection and Law Enforcement Takedowns](https://unit42.paloaltonetworks.com/fast-flux-101/)

The concent of fast flux is having many different IP addresses that are associated with a domain name which is constantly changing.

# Domain Names (Simple)


Source(s): <https://tryhackme.com/room/pyramidofpainax> 
