---
title: Stocker
date: 2023-03-02 02:47:00 -0500
categories: [Walkthrough, Hackthebox, CTF]
tags: [web, wfuzz, nmap, nosql, dynamic XSS]
published: true
---

## Enumeration

### nmap

nmap shows us two open ports 22,80

### wfuzz

```shell 
wfuzz -c -t 50 -u http://stocker.htb -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -H "Host: FUZZ.stocker.htb" --hc 301
```

## dev.stocker.htb

We start by capturing a login request in burpsquite.

![Capturing a login request in burp](/assets/stocker02.png)

This server is using Express. We can use a json authentication bypass from [payload all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection#authentication-bypass). 

Set the content-type to json and use this json to access `/stock`

```shell
{"username": {"$ne": null}, "password": {"$ne": null}}
```

### /stock

We can see adding stock and capturing the add to cart request in the burp suite proxy that this uses more json to create the pdf. We can modify the json and [perform service side xss](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf).

![Dynamic Server side XSS](/assets/stocker03.png)

We pick up a few users here:

```shell
angoose:x:1001:1001:,,,:/home/angoose:/bin/bash
_laurel:x:998:998::/var/log/laurel:/bin/false
```

I will have to come back to this as I am stuck again :)
